jQuery((function($){let currentFormData;function wcdp_submit(step){if(check_validity("#wcdp-ajax-send")){$("#wcdp-spinner").show(),$("#wcdp-ajax-button").hide();const form=$("#wcdp-ajax-send"),formData=form.serialize();$.ajax({type:"POST",url:form.attr("action"),data:formData}).done((function(response){switch(response.success){case!0:$(".woocommerce-error").remove(),$("body").trigger("update_checkout"),$("#wcdp-ajax-button").show(),$("#wcdp-spinner").hide(),response.recurring?($("#createaccount").prop("checked",!0).trigger("change"),$(".create-account:has(#createaccount)").hide()):$(".create-account:has(#createaccount)").show(),wcdp_steps(step);break;default:error_message(response.message,response.reload)}})).fail((function(){$("#wcdp-spinner").hide(),error_message($(".wcdp-choose-donation").attr("wcdp-error-default"))}))}}function check_validity(id){try{return $(id)[0].reportValidity()&&(0==$("#variation_id").length||""!=$("#variation_id").attr("value"))}catch(err){return!1}}function error_message(message="An unexpected error occurred. Please reload the page and try again. If the problem persists, please contact our support team.",reload=!0){reload||$("#wcdp-ajax-button").show(),$("#wcdp-spinner").hide(),$("#wcdp-ajax-error").remove(),$("form.checkout.woocommerce-checkout").prepend('<ul class="woocommerce-error" id="wcdp-ajax-error" role="alert"><li></li></ul>'),$("#wcdp-ajax-error li").text(message)}$("#wcdp-ajax-send").on("submit",(function(e){e.preventDefault();const serialized=$("#wcdp-ajax-send").serialize();currentFormData!=serialized?(currentFormData=serialized,wcdp_submit("2")):wcdp_steps(2)}));let time=0;$(".wcdp-body > #wcdp-ajax-send").on("input blur keyup paste change",(function(){currentFormData!=$("#wcdp-ajax-send").serialize()&&(time++,currentFormData=$("#wcdp-ajax-send").serialize(),setTimeout((function(){time--,0==time&&wcdp_submit()}),1300))}));let ecpresstime=0,currentprice=0;$(".wcdp-body").on("input blur keyup paste change",(function(){$(".wcdp-express-amount").val($("#wcdp-donation-amount").val()),ecpresstime++,setTimeout((function(){ecpresstime--,0==ecpresstime&&currentprice!=$("#wcdp-donation-amount").val()&&(currentprice=$("#wcdp-donation-amount").val(),$(document.body).trigger("woocommerce_variation_has_changed"))}),500)}));let currentStep=1;function wcdp_steps(step){const root=$(":root")[0];switch(root.style.setProperty("--wcdp-step-2","var(--wcdp-main)"),root.style.setProperty("--wcdp-step-3","var(--wcdp-main)"),step){case"3":$("#wcdp-step-2").show(),$("form.checkout").find(".input-text:visible, select:visible, input:checkbox:visible").trigger("validate"),$("#wcdp-step-2 .woocommerce-invalid:visible").length>0?($("#wcdp-invalid-fields").show(),$("#place_order").hide()):($("#wcdp-invalid-fields").hide(),$("#place_order").show()),root.style.setProperty("--wcdp-step-3","var(--wcdp-main-2)");case"2":root.style.setProperty("--wcdp-step-2","var(--wcdp-main-2)");break;case"1":break;default:return}$(".wcdp-style5-active").removeClass("wcdp-style5-active"),$("#wcdp-style5-step-"+step).addClass("wcdp-style5-active"),$("#wcdp-progress-bar").css("width",33.33*(parseInt(step)-1)+"%"),$(".wcdp-tab").hide(),$("#wcdp-step-"+step).show(),currentStep=step}$(".wcdp-button,.wcdp-step").click((function(){const step=$(this).attr("value");1!=currentStep?wcdp_steps(step):1!=step&&(currentFormData!=$("#wcdp-ajax-send").serialize()?(currentFormData=$("#wcdp-ajax-send").serialize(),wcdp_submit(step)):wcdp_steps(step))}));let express_heading_timeout=10;function express_checkout_heading(){$("#wc-stripe-payment-request-button").children().length+$("#ppc-button").children().length>0?$(".wcdp-express-heading").show():express_heading_timeout<1e4&&(express_heading_timeout*=2,setTimeout(express_checkout_heading,express_heading_timeout))}$(document).ready((function wcdp_setup(){$(".wcdp-loader").hide(),$(".wc-donation-platform").css({visibility:"visible","animation-name":"wcdp-appear-animation","animation-duration":"1s"}),wcdp_open(!1);try{0!=$("#wcdp-donation-amount").val()&&$("#wcdp-ajax-send").trigger("change"),$(".wcdp-choose-donation")[0].checkValidity()&&(currentFormData=$("#wcdp-ajax-send").serialize(),wcdp_submit()),$(".woocommerce-checkout select").selectWoo()}finally{$("#wcdp-ajax-send,.wcdp_options").trigger("change"),setTimeout(express_checkout_heading,express_heading_timeout)}})),window.onhashchange=function(){wcdp_open(!1)},$(".wcdp-modal-open").click((function(){wcdp_open(!0)})),$(document).on("keypress","input",(function(e){"Escape"==e.key&&wcdp_close()})),$(".wcdp-modal-close").click(wcdp_close);var wcdpOpen=!1;function wcdp_close(){wcdpOpen&&($(".wcdp-overlay").hide(),$("body").css("overflow-y"," auto"),history.pushState("",document.title,window.location.pathname+window.location.search),wcdpOpen=!1)}function wcdp_open(direct){const x=$(".wcdp-overlay");(direct||"#wcdp-form"==location.hash&&x.length>0)&&(x.show(),$("body").css("overflow-y","hidden"),wcdpOpen=!0)}$(".wcdp_options").change((function(){var name=this.attributes["wcdp-name"].value,value=$('input[name="'+name+'"]:checked').val();if(value){$("#wcdp-"+name).val(value);const el=$("#"+name);el.val(value),el.trigger("change")}})),$(document).on("change","#wcdp_fee_recovery",(function(){setTimeout((function(){$("body").trigger("update_checkout")}),400)})),$(document).on("change","input[name='payment_method']",(function(){$("#wcdp_fee_recovery").prop("checked")&&setTimeout((function(){$("body").trigger("update_checkout")}),400)})),$("#wcdp-range").on("input",(function(){const range=$("#wcdp-range"),amount=$("#wcdp-donation-amount");amount.val(range.val()),range.val()==range.attr("max")&&amount.select()})),$(".wcdp-amount-range-field").on("input",(function(){$("#wcdp-range").val($("#wcdp-donation-amount").val())})),$("#wcdp-donation-amount").on("change",(function(){var name="#wcdp_value_"+$("#wcdp-donation-amount").val().replace(/./g,"-");0==$(name).length?$("#wcdp_value_other").prop("checked",!0):$(name).prop("checked",!0)})),$("#wcdp_value_other").click((function(){$("#wcdp-donation-amount").focus()})),$(".wcdp-choose-donation").on("change",(function(){$(".wcdp_su input").each((function(){0==$("#"+this.name+' option[value="'+this.value+'"]').length?this.setAttribute("disabled","true"):this.removeAttribute("disabled")}))}))}));